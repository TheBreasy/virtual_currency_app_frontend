const base_url="https://exchange-nodejs.herokuapp.com";localStorage.getItem("token")||(window.location.href="login.html"),primus=Primus.connect(base_url+"/js/primus.js",{reconnect:{max:1/0,min:500,retries:10}}),fetch(base_url+"/users/"+localStorage.getItem("id"),{method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>e.json()).then(e=>{var t=`<img class="card__icon mb-1" src="images/coins.svg" alt="coins">
         <p class="mb-1 color-grey font-bold font-size-l">${e.coins}</p>
         <span class="d-block uppercase font-size-xs">coins</span>`;document.querySelector(".amount").insertAdjacentHTML("afterbegin",t);e=`<div class="py-1">
            <h2 class="text-center uppercase color-blue font-bold">Welcome, ${e.firstname}</h2>
        </div>`;document.querySelector("header").insertAdjacentHTML("afterend",e)}).catch(e=>{console.log(e)}),primus.on("data",e=>{"addTransfer"===e.action&&updateNotifications(e.data)});let updateNotifications=t=>{document.querySelector(".notifications").innerHTML="";for(let e=0;e<=t.data.transfers.length;e++){var a=t.user.nickname;t.data.transfers[e].recipient===a&&(a=`<div class="card d-flex align-items-center mt-1 px-1 py-half">
                    <img class="card__icon--xs" src="images/notification.svg" alt="notification">
                    <span class="pl-1">Received â‚¡${t.data.transfers[e].amount} from ${t.data.transfers[e].sender}</span>
                </div>`,document.querySelector(".notifications").insertAdjacentHTML("afterend",a))}};fetch(base_url+"/api/v1/transfers/",{method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>e.json()).then(e=>{updateNotifications(e)}).catch(e=>{console.log(e)});